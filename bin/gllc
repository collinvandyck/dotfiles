#!/usr/bin/env bash
set -euo pipefail

# Runs git log, specifying main and master globs.
#
# Any additional args will be globbed as well. If there are not args, the
# current user will be globbed.

globs=("--decorate-refs=HEAD")

add_glob() {
    globs+=("--glob=$1")
    globs+=("--decorate-refs=$1")
}

add_glob 'refs/*/main'
add_glob 'refs/*/master'

# Process arguments
if [[ $# -gt 0 ]]; then
    for arg in "$@"; do
        add_glob "refs/**${arg}**"
    done
else
    add_glob "refs/*/${USER}/*"
fi

# Execute git command with all globs
git ll "${globs[@]}"

