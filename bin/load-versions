#!/usr/bin/env bash
# Parse .versions and export as DOTFILES_*_VERSION variables
# Usage: source ~/.dotfiles/bin/load-versions

_dotfiles_dir="${DOTFILES_DIR:-$HOME/.dotfiles}"
while IFS='=' read -r key value; do
    [[ "$key" =~ ^#.*$ || -z "$key" ]] && continue
    key="${key// /}"
    value="${value// /}"
    var_name="DOTFILES_${key^^}_VERSION"
    var_name="${var_name//-/_}"
    export "$var_name=$value"
done < "$_dotfiles_dir/.versions"
