#!/usr/bin/env bash

set -euo pipefail

# https://realpython.com/python-typer-cli/

name=${1:-}
dir=~/code

usage() {
	echo "usage: $(basename "$0") [name]"
	exit 1
}

if [ -z "$name" ]; then
	name=wip
	dir=$(mktemp -d)
fi

cd "$dir"

if [ -d "$name" ]; then
	echo "error: $name already exists"
	exit 1
fi

uv init "$name"
cd "$name"
uv add --dev pytest

cat <<eos > main.py
def main():
    print("Hello World!")

if __name__ == "__main__":
    main()
eos

cat <<eos > test_main.py
def test_hello():
	pass
eos

cat <<eos > .justfile
run:
	@uv run python main.py

test:
	@uv run pytest
eos

nvim main.py
exec zsh
